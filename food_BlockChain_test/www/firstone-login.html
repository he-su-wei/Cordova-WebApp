<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="css/login.css">
  <link rel="stylesheet" href="icon/css/all.css">
</head>
<body>
  <!--------------------------------------------------導航欄------------------------------------------------------------->
  <nav class="nav_bar flex">
    <div class="item"> <img src="img/csie.png" class="" alt="..." width="40"> </div>
    <div class="item flex-2"> <h3>食安與健康飲食</h3> </div>
    <div class="item"><i class="fas fa-bars fa-2x" onclick="openNav()"></i> </div>
  </nav>
  <!--------------------------------------------------清單內容------------------------------------------------------------->
  <div id="mySidenav" class="sidenav">
    <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
    <a href="signup.html">註冊</a>
    <a href="store-login.html">店家登入</a>
    <a href="customer-login.html">顧客登入</a>
    <a href="#">訪客模式</a> 
    <a href="#">關於</a>
  </div>
  <!--------------------------------------------------登入------------------------------------------------------------->
  <div class="divForm">
    <div class="horizontal-vertical-center">
          <h1 style="margin: 0px auto 20%;">Login</h1>
          <input id="address" type="text" placeholder="Address 地址" required pattern="[0-9a-zA-Z]{42,42}"/>  
          <input id="account" type="text" placeholder="Account 帳號" required pattern="[0-9a-zA-Z]{4,8}"/>    
          <input id="password" type="password" placeholder="Password 密碼" required pattern="[0-9a-zA-Z]{8,}"/>
          <button type="button" class="" onclick="javascript:check();">Enter</button>
      </div>
    </div>
  </div>

  <script>
    function openNav() {
      document.getElementById("mySidenav").style.width = "250px";
    }
    
    function closeNav() {
      document.getElementById("mySidenav").style.width = "0";
    }
  </script>

  <script src="cordova.js"></script>
  <script src="js/index.js"></script>

  <!-- webSocket connect -->
  <script>
    var ws = new WebSocket("ws://192.168.68.53:6001");

    ws.onopen = function () {
      console.log('open');
      ws.send(0);
    };
    
    // ws.onmessage = function (event) {
    //   // console.log(event.data)
    //   var str = event.data;
    //   document.getElementById('bool').value = str;
    // };
    function check(){
      var address = document.getElementById('address').value;
      var account = document.getElementById('account').value;
      var password = document.getElementById('password').value;

      ws.send(address);
      ws.send(account);
      ws.send(password);
      
      ws.onmessage = function (event) {
        // console.log(event.data)
        var check = event.data;
        if (check=="true"){
          localStorage.address = address;
          alert('登入成功');
          window.location.href='loginafter.html';
        }
        else if (check=="false"){
          alert('資料錯誤');
        }
      };
      
    };
  </script>

</body>
</html> 
